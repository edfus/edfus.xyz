<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="anonymous"><link rel="dns-prefetch" href="//cdn.jsdelivr.net"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=auto"><title>win10快速部署与优化 | EDFUS&#39;s Blog</title><link rel="shortcut icon" href="/favicon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/edfus/storage/favicons/favicon-32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/edfus/storage/favicons/favicon-16.png"><meta name="theme-color" content="#222"><link rel="canonical" href="https://edfus.xyz/2019/12/deployment-win10/"><meta name="renderer" content="webkit"><meta name="format-detection" content="telephone=no, email=no"><meta http-equiv="content-language" content="zh-CN,en-US"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 4.2.0"></head><body><div id="container"><div id="wrap"><header id="header"><div id="banner"></div><div id="header-outer" class="outer"><div id="header-title" class="inner"><h1 id="logo-wrap"><a href="/" id="logo" style="cursor:text">EDFUS&#39;s Blog</a></h1></div><div id="header-inner" class="inner"><nav id="main-nav"><a id="main-nav-toggle" class="nav-icon"></a> <a class="main-nav-link" href="/">Home | 思</a> <a class="main-nav-link" href="/categories/tech">Tech | 物</a> <a class="main-nav-link" href="/about">About | 我</a> <a class="main-nav-link" href="/more">MORE | 实验&amp;阅读</a></nav><nav id="sub-nav"><a id="nav-search-btn" class="nav-icon" title="搜索" href="javascript: void(0)"></a></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search" id="search-input" tabindex="-1"> <label for="search-input" class="visually-hidden">Powered by Google's site search</label><style>.visually-hidden{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;width:1px;margin:-1px;overflow:hidden;padding:0;position:absolute}</style><input type="hidden" name="sitesearch" value="edfus.xyz"></form></div></div></div></header><div class="outer"><section id="main"><article id="post-deployment-win10" class="article article-type-post" itemscope itemprop="blogPosts" itemtype="http://schema.org/BlogPosting"><div class="article-meta"><ul class="article-header-tag-list" itemprop="keywords"><li class="article-header-tag-list-item"><a class="article-header-tag-list-link" href="/categories/tech/Win10/" rel="tag">Win10</a></li><li class="article-header-tag-list-item"><a class="article-header-tag-list-link" href="/categories/tech/优化/" rel="tag">优化</a></li><li class="article-header-tag-list-item"><a class="article-header-tag-list-link" href="/categories/tech/总结/" rel="tag">总结</a></li></ul><time datetime="2019-12-18T16:00:00.000Z" itemprop="dateCreated" class="article-date">2019-12-19</time><div class="article-category"><a class="article-category-link" href="/categories/tech/">tech</a></div></div><div class="article-inner toc-on"><header class="article-header"><h1 class="article-title" itemprop="name">win10快速部署与优化</h1></header><div class="article-entry" itemprop="articleBody"><div id="toc"><div id="heading-index">目录</div><ol class="md-toc"><li class="md-toc-item md-toc-level-2"><a class="md-toc-link" href="#流程"><span class="md-toc-text">流程</span></a><ol class="md-toc-child"><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#删除系统应用-先删除以免待会儿覆盖相关文件指后缀的打开方式"><span class="md-toc-text">删除系统应用(先删除以免待会儿覆盖相关文件指后缀的打开方式)</span></a><ol class="md-toc-child"><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#管理员权限打开的powershell里输入并删除相应文件"><span class="md-toc-text">管理员权限打开的powershell里输入并删除相应文件</span></a></li></ol></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#改字体"><span class="md-toc-text">改字体</span></a><ol class="md-toc-child"><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#中文版windows"><span class="md-toc-text">中文版windows</span></a></li><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#英文版windows"><span class="md-toc-text">英文版windows</span></a><ol class="md-toc-child"><li class="md-toc-item md-toc-level-5"><a class="md-toc-link" href="#键盘布局"><span class="md-toc-text">键盘布局</span></a></li><li class="md-toc-item md-toc-level-5"><a class="md-toc-link" href="#英文版的字体更改"><span class="md-toc-text">英文版的字体更改</span></a></li><li class="md-toc-item md-toc-level-5"><a class="md-toc-link" href="#英文版的中文字体渲染（不推荐）"><span class="md-toc-text">英文版的中文字体渲染（不推荐）</span></a></li></ol></li></ol></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#Hype-v"><span class="md-toc-text">Hype-v</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#office"><span class="md-toc-text">office</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#Manual-mode-without-leaving-any-KMS-emulator-traces-in-the-system"><span class="md-toc-text">Manual mode (without leaving any KMS emulator traces in the system.)</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#Auto-Renewal-mode-the-system-itself-handle-and-renew-activation-per-schedule"><span class="md-toc-text">Auto Renewal mode (the system itself handle and renew activation per schedule.)</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#flash-player"><span class="md-toc-text">flash player</span></a><ol class="md-toc-child"><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#pepflashplayer-chrome"><span class="md-toc-text">pepflashplayer(chrome)</span></a></li><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#规避国内版flash"><span class="md-toc-text">规避国内版flash</span></a></li></ol></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#系统设置"><span class="md-toc-text">系统设置</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#软件设置"><span class="md-toc-text">软件设置</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#美化"><span class="md-toc-text">美化</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#task-scheduler设定"><span class="md-toc-text">task scheduler设定</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#导入微软拼音词典和用户自设词典"><span class="md-toc-text">导入微软拼音词典和用户自设词典</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#迁移hexo和git"><span class="md-toc-text">迁移hexo和git</span></a><ol class="md-toc-child"><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#切换npm源"><span class="md-toc-text">切换npm源</span></a></li><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#node-modules"><span class="md-toc-text">node_modules</span></a></li><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#gulp"><span class="md-toc-text">gulp</span></a></li><li class="md-toc-item md-toc-level-4"><a class="md-toc-link" href="#git更新ssh"><span class="md-toc-text">git更新ssh</span></a></li></ol></li></ol></li><li class="md-toc-item md-toc-level-2"><a class="md-toc-link" href="#附："><span class="md-toc-text">附：</span></a><ol class="md-toc-child"><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#chrome的webRTC泄漏原IP-即使挂了VPN"><span class="md-toc-text">chrome的webRTC泄漏原IP(即使挂了VPN)</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#禁用win10更新（家庭版）（不推荐）"><span class="md-toc-text">禁用win10更新（家庭版）（不推荐）</span></a></li><li class="md-toc-item md-toc-level-3"><a class="md-toc-link" href="#win10激活"><span class="md-toc-text">win10激活</span></a></li></ol></li></ol></div><hr><p>没有我的颜色的东西算不得我的东西（</p><p>基于上面这原因（？）<span class="chineselangcomma">，</span>我对我的笔记本做了不少优化<span class="chineselangstop">。</span></p><p>可是在经历了人生第一次重装系统后我才发现操作越多<span class="chineselangcomma">，</span>重现起来越费力这个道理……</p><p>本着方便化流程化自动化的目的<span class="chineselangcomma">，</span>有了此文<span class="chineselangstop">。</span>2019-12-19<span class="chineselangstop">。</span></p><hr><p>之后的更新大抵也是某次重装后的重现过程中对之前操作的增改<span class="chineselangstop">。</span></p><p>顺便一提我越来越觉得Mac香了……无力吐槽文都死<span class="chineselangstop">。</span></p><hr><h2 id="流程">流程</h2><h3 id="删除系统应用-先删除以免待会儿覆盖相关文件指后缀的打开方式">删除系统应用(先删除以免待会儿覆盖相关文件<sup>指后缀</sup>的打开方式)</h3><h4 id="管理员权限打开的powershell里输入并删除相应文件">管理员权限打开的powershell里输入并删除相应文件</h4><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-AppxPackage -AllUsers</span><br></pre></td></tr></table></figure><p>用这个可列出全部应用（和你现有的无关）</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-AppxPackage</span> *gethelp* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *<span class="number">3</span>dbuilder* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *windowsalarms* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *windowscalculator* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *windowscommunicationsapps* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *officehub* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *skypeapp* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *zunemusic* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *windowsmaps* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *solitairecollection* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *bingfinance* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *zunevideo* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *bingnews* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *people* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *windowsphone* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *photos* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="comment"># Get-AppxPackage *windowsstore* | Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *bingsports* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *soundrecorder* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *bingweather* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *xboxapp* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *xbox* | <span class="built_in">Remove-AppxPackag</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *phone* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *communi* | <span class="built_in">Remove-AppxPackage</span></span><br><span class="line"><span class="built_in">Get-AppxPackage</span> *bing* | <span class="built_in">Remove-AppxPackage</span></span><br></pre></td></tr></table></figure><ul><li>彻底卸载<a href="https://jingyan.baidu.com/article/9f7e7ec0ec9f676f28155490.html" target="_blank" rel="noopener">onedrive</a></li><li>还原已删除的 <a href="https://docs.microsoft.com/zh-cn/onedrive/restore-deleted-onedrive" target="_blank" rel="noopener">OneDrive</a></li></ul><p>附:</p><blockquote><ul><li><p>重置Microsoft store</p><blockquote><p>您可以尝试以下方案进行操作<span class="chineselangcomma">，</span>看看是否有效：</p><p><code>设置&gt;&gt;应用&gt;&gt;应用和功能&gt;&gt;找到应用商店&gt;&gt;高级选项&gt;&gt;重置&lt;span class='chineselangstop'&gt;。&lt;/span&gt;</code></p><p>另外<span class="chineselangcomma">，</span>您还可以尝试清理应用商店的缓存<span class="chineselangcomma">，</span>看看是否可以恢复正常：</p><p><code>按“Win+R”键-在运行窗口中-键入 WSReset.exe并点击“ 运行 ”&lt;span class='chineselangstop'&gt;。&lt;/span&gt;</code></p></blockquote></li><li><p>删除mircrosoft store</p><blockquote><p>get-appxpackage <em>store</em> | remove-Appxpackage</p></blockquote></li><li><p>再次安装：</p><blockquote><p>add-appxpackage -register &quot;C:\Program Files\WindowsApps*Store*\AppxManifest.xml&quot; -disabledevelopmentmode</p></blockquote></li></ul></blockquote><p>关于人脉/EDGE这类删除会报Error 0x80073CFA的软件：<a href="http://woshub.com/remove-appxpackage-0x80073cfa-removal-failed/" target="_blank" rel="noopener">Error 0x80073CFA: Can’t Uninstall Apps using Remove-AppxPackage in Windows 10</a></p><h3 id="改字体">改字体</h3><p>一定要记得先安装字体😂</p><h4 id="中文版windows">中文版windows</h4><ul><li><p>不推荐</p><blockquote><ul><li><p><a href="https://zhuanlan.zhihu.com/p/20379053" target="_blank" rel="noopener">给Windows系统换字体的一点经验</a></p></li><li><p>建议先备份C:\Windows\Fonts里的内容<br>按住shift点击重启<span class="chineselangdash">——</span>疑难解答<span class="chineselangdash">——</span>高级选项<span class="chineselangdash">——</span>命令提示符</p></li></ul><blockquote><p>输入命令：xcopy D:\NewFont C:\Windows\Fonts<span class="chineselangcomma">，</span>xcopy是复制文件夹的命令<span class="chineselangcomma">，</span>D:\NewFont是我将要替换的字体文件的路径<span class="chineselangcomma">，</span>这个就看大家把字体文件存放在哪了<span class="chineselangcomma">，</span>C:\Windows\Fonts是目标路径<span class="chineselangcomma">，</span>大家都一样的</p></blockquote><p>但我个人在运用时发现==此状态下无Z盘（为F盘）<span class="chineselangcomma">，</span>c盘不是用户盘==<span class="chineselangcomma">，</span>建议先<kbd>dir</kbd>确认清楚盘后再进行相应的修改<br><br></p></blockquote></li><li><p>我以前的方法（不能100%覆盖）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts]</span><br><span class="line">&quot;Microsoft YaHei &amp; Microsoft YaHei UI (TrueType)&quot;&#x3D;&quot;droidsansfallback_0.ttf&quot;</span><br><span class="line">&quot;Microsoft YaHei Bold &amp; Microsoft YaHei UI Bold (TrueType)&quot;&#x3D;&quot;droidsansfallback_0.ttf&quot;</span><br><span class="line">&quot;Microsoft YaHei Light &amp; Microsoft YaHei UI Light (TrueType)&quot;&#x3D;&quot;droidsansfallback_0.ttf&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\FontSubstitutes]</span><br><span class="line"></span><br><span class="line">&quot;Microsoft YaHei&quot;&#x3D;&quot;Droid Sans Fallback&quot;</span><br><span class="line">&quot;Microsoft YaHei UI&quot;&#x3D;&quot;Droid Sans Fallback&quot;</span><br></pre></td></tr></table></figure><p>将droidsansfallback_0.ttf改为你想要的文字在font文件夹下的源文件名<span class="chineselangcomma">，</span>Droid Sans Fallback改为文字名即可<br><br></p></li></ul><p>另外更改浏览器字体<span class="chineselangstop">。</span>（不推荐）</p><h4 id="英文版windows">英文版windows</h4><h5 id="键盘布局">键盘布局</h5><p>中国的键盘布局和美国的是相同的<span class="chineselangcomma">，</span>但与英国不同<span class="chineselangcomma">，</span>所以无论是使用English(United Kingdom) / English(United States)<span class="chineselangcomma">，</span>把language-Preferred language-keyboard改成US即可</p><h5 id="英文版的字体更改">英文版的字体更改</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts]</span><br><span class="line">&quot;Segoe UI (TrueType)&quot;&#x3D;&quot;droidsansfallback.ttf&quot;</span><br><span class="line">&quot;Segoe UI Bold (TrueType)&quot;&#x3D;&quot;droidsansfallback.ttf&quot;</span><br><span class="line">&quot;Segoe UI Bold Italic (TrueType)&quot;&#x3D;&quot;droidsansfallback.ttf&quot;</span><br><span class="line">&quot;Segoe UI Italic (TrueType)&quot;&#x3D;&quot;droidsansfallback.ttf&quot;</span><br><span class="line">&quot;Segoe UI Light (TrueType)&quot;&#x3D;&quot;droidsansfallback.ttf&quot;</span><br><span class="line">&quot;Segoe UI Semibold (TrueType)&quot;&#x3D;&quot;droidsansfallback.ttf&quot;</span><br><span class="line">&quot;Segoe UI Symbol (TrueType)&quot;&#x3D;&quot;droidsansfallback.ttf&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\FontSubstitutes]</span><br><span class="line"></span><br><span class="line">&quot;Segoe UI&quot;&#x3D;&quot;Droid Sans Fallback&quot;</span><br></pre></td></tr></table></figure><h5 id="英文版的中文字体渲染（不推荐）">英文版的中文字体渲染（不推荐）</h5><ol><li><p><a href="https://www.zhihu.com/question/58055812/answer/253352421" target="_blank" rel="noopener">win10英文版下中文字体如何像中文版一样显示？ - 徐苡瑄的回答 - 知乎</a></p></li><li><p><a href="https://shajisoft.com/shajisoft_wp/cn/%E5%AE%8C%E7%BE%8E%E8%A7%A3%E5%86%B3%E4%B8%AD%E6%96%87%E5%9C%A8%E8%8B%B1%E6%96%87windows%E4%B8%8A%E6%98%BE%E7%A4%BA%E9%AB%98%E7%9F%AE%E4%B8%8D%E4%B8%80%E7%9A%84%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">完美解决中文在英文Windows上显示高矮不一的问题</a></p><p><img src="//cdn.jsdelivr.net/gh/edfus/storage/images/.io/2019/12/deployment-win10/2020-01-01_135609.png.webp" alt="image"></p><blockquote><p><a href="https://www.zhihu.com/people/Misaka17777" target="_blank" rel="noopener">死肥宅</a>： 7 天前</p><p>不行<span class="chineselangcomma">，</span>打开这个设置所有GBK中文的软件全部乱码</p><blockquote><p>我也遇到了这个↑问题</p></blockquote></blockquote></li></ol><h3 id="Hype-v">Hype-v</h3><p>win10<strong>家庭版</strong>开启hype-v功能：保存为.bat以管理员身份运行↓</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pushd</span> "%~dp0"</span><br><span class="line"><span class="built_in">dir</span> /b <span class="variable">%SystemRoot%</span>\servicing\Packages\*Hyper-V*.mum &gt;hyper-v.txt</span><br><span class="line"><span class="keyword">for</span> /f <span class="variable">%%i</span> <span class="keyword">in</span> ('<span class="built_in">findstr</span> /i . hyper-v.txt <span class="number">2</span>^&gt;<span class="built_in">nul</span>') <span class="keyword">do</span> dism /online /norestart /add-package:"<span class="variable">%SystemRoot%</span>\servicing\Packages\<span class="variable">%%i</span>"</span><br><span class="line"><span class="built_in">del</span> hyper-v.txt</span><br><span class="line">Dism /online /enable-feature /featurename:Microsoft-Hyper-V-All /LimitAccess /ALL</span><br></pre></td></tr></table></figure><p>注意载入iso时要一直长按任意键进入安装界面<span class="chineselangcomma">，</span>否则报错</p><h3 id="office">office</h3><p>白嫖<span class="chineselangcomma">，</span>所以用KMS激活</p><p>关于KMS的介绍：<a href="https://docs.microsoft.com/en-us/previous-versions/tn-archive/ff793409(v=technet.10)?redirectedfrom=MSDN" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/previous-versions/tn-archive/ff793409(v=technet.10)?redirectedfrom=MSDN</a></p><p>KMS服务器只是个激活的服务器<span class="chineselangcomma">，</span>目前没有任何向客户端发指令的东西<span class="chineselangcomma">，</span>不能操作客户端<span class="chineselangstop">。</span>180天激活一次<span class="chineselangstop">。</span>（但用百度搜索出的KMS激活软件一般会捆绑一些东西）</p><p><a href="https://github.com/kkkgo/KMS_VL_ALL" target="_blank" rel="noopener">https://github.com/kkkgo/KMS_VL_ALL</a></p><blockquote><h3 id="Manual-mode-without-leaving-any-KMS-emulator-traces-in-the-system">Manual mode (without leaving any KMS emulator traces in the system.)</h3><p>make sure that auto renewal solution is not installed, or remove it<br>then, just run <strong>Activate.cmd</strong></p><blockquote><p>You will have to run Activate.cmd again before the <strong>KMS activation period expire</strong>(default 180 days).<br>You can run Activate.cmd anytime during that period to renew the period to the max interval.<br>If Activate.cmd is accidentally terminated before it completes, run the script again to clean any leftovers.</p></blockquote><h3 id="Auto-Renewal-mode-the-system-itself-handle-and-renew-activation-per-schedule">Auto Renewal mode (the system itself handle and renew activation per schedule.)</h3><p>first, run the script AutoRenewal-Setup.cmd, press <strong>Y</strong> to approve the installation<br>then, just run <strong>Activate.cmd</strong></p><blockquote><p>If you use Antivirus software, it is best to exclude this file from scanning protection: <strong>C:\Windows\System32\SppExtComObjHook.dll</strong></p></blockquote></blockquote><hr><p>这里所用下载/激活软件是Office Tool Plus<span class="chineselangcomma">，</span>捡懒<span class="chineselangstop">。</span></p><p>我不知道这个软件有没有背地做一些事……</p><p>软件需下载ProPlus2019 - 长期企业版 volume（非零售版）</p><p>先安装证书<span class="chineselangcomma">，</span>再安装key<span class="chineselangcomma">，</span>其次设置kms服务器地址<span class="chineselangcomma">，</span>最后激活</p><p>KMS激活的GVLK key: <a href="https://docs.microsoft.com/zh-cn/DeployOffice/vlactivation/gvlks" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/DeployOffice/vlactivation/gvlks</a></p><p>KMS服务器地址: (来源：<a href="https://www.coolhub.top/archives/14" target="_blank" rel="noopener">https://www.coolhub.top/archives/14</a>)</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">kms.loli.beer</span><br><span class="line">kms.loli.cab</span><br><span class="line">kms.loli.best</span><br><span class="line">kms.cangshui.net</span><br><span class="line">kms.03k.org</span><br><span class="line">kms.v0v.bid</span><br><span class="line">kms.library.hk</span><br><span class="line">kms.moeclub.org</span><br><span class="line">kms.kuretru.com</span><br><span class="line">kms.huengyamm.xyz</span><br><span class="line">kms.ghpym.com</span><br><span class="line">kms.ddz.red</span><br><span class="line">kms.iaini.net</span><br><span class="line">kms.ifibe.com</span><br><span class="line">kms.lotro.cc</span><br><span class="line">kms.wxlost.com</span><br><span class="line">kms.ymgblog.com</span><br><span class="line">kms.ijio.net</span><br><span class="line">kms.mcfx.us</span><br><span class="line">kms.chinancce.com</span><br><span class="line">kms8.MSGuides.com</span><br><span class="line">kms.jm33.me</span><br><span class="line">kms.kmzs123.cn</span><br><span class="line">kms.cin.ink</span><br><span class="line">kms.izetn.cn</span><br><span class="line">kms.ddddg.cn</span><br><span class="line">kms.zhuxiaole.org</span><br><span class="line">kms.magicwall.org</span><br><span class="line">kms.luody.info</span><br><span class="line">kms.mrxn.net</span><br><span class="line">kms.bige0.com</span><br><span class="line">zh.us.to</span><br><span class="line">windows.kms.app</span><br><span class="line">home.aalook.com</span><br><span class="line">nb.shenqw.win</span><br><span class="line">cy2617.jios.org</span><br><span class="line">enter.picp.net</span><br></pre></td></tr></table></figure><blockquote><p>上海交通大学：<a href="http://kms.sjtu.edu.cn" target="_blank" rel="noopener">kms.sjtu.edu.cn</a></p><p>武汉理工大学：<a href="http://kms.whut.edu.cn" target="_blank" rel="noopener">kms.whut.edu.cn</a></p><p>华北电力大学：202.204.74.218</p><p>中国科学技术大学：<a href="http://kms.ustc.edu.cn" target="_blank" rel="noopener">kms.ustc.edu.cn</a></p><p>南京航空航天大学：<a href="http://kms.nuaa.edu.cn" target="_blank" rel="noopener">kms.nuaa.edu.cn</a></p><p>中山大学：<a href="http://kms.sysu.edu.cn" target="_blank" rel="noopener">kms.sysu.edu.cn</a></p><p><strong>激活只面向校内全体师生<span class="chineselangcomma">，</span>如果用户不在校内<span class="chineselangcomma">，</span>需要使用学校提供的 VPN<span class="chineselangcomma">，</span>连接后方可使用高校提供的 KMS 激活 Office<span class="chineselangstop">。</span></strong></p></blockquote></blockquote><h3 id="flash-player">flash player</h3><h4 id="pepflashplayer-chrome">pepflashplayer(chrome)</h4><p>在这个<a href="https://cn.dll-files.com/pepflashplayer.dll.html" target="_blank" rel="noopener">网站</a>下载一个pepflashplayer.dll（旧版本）<span class="chineselangcomma">，</span>关闭更新<span class="chineselangcomma">，</span>避免重橙的骚扰</p><blockquote><p>谷歌浏览器直接打chrome://version/<br><img src="//cdn.jsdelivr.net/gh/edfus/storage/images/.io/2019/12/deployment-win10/20190228122614550.png.webp" alt="img"></p><p>将这个路径的pepflashplayer.dll的高版本换为你下载好的那个</p></blockquote><h4 id="规避国内版flash">规避国内版flash</h4><ol><li><p>不建议在电脑上安装flash player<span class="chineselangcomma">，</span>直接用浏览器自带的</p></li><li><p>本地玩swf游戏的话可以直接用potplayer之类的播放器打开的<span class="chineselangcomma">，</span>嫌进度条碍眼的话写个最简单的html<code>&lt;embed src=&quot;疯狂小人乱斗.swf&quot; style=&quot;height: 100vh;width: 100vw;&quot;&gt;</code>就好咯（swf是矢量的,可无限放大<span class="chineselangcomma">，</span>但似乎部分swf文件中也有位图）</p></li><li><p>要下就翻墙去https://get.adobe.com/cn/flashplayer/ 下载</p></li><li><p>安装了国内版flash该怎么办？（禁止弹窗和flash service的监控）</p><blockquote><p>任务管理器-服务-FlashHelperService禁用</p></blockquote><blockquote><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">taskkill</span> /f /t /im FlashHelperService.exe</span><br><span class="line"><span class="built_in">ping</span> <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="built_in">del</span> /f /s /q C:\Windows\SysWOW64\Macromed\Flash\FlashHelperService.exe</span><br><span class="line">Reg delete "HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\MAIN\FeatureControl\FEATURE_BROWSER_EMULATION" /v "FlashHelperService" /f</span><br><span class="line">Reg delete "HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\services\Flash Helper Service" /f</span><br><span class="line">Reg delete "HKEY_LOCAL_MACHINE\SYSTEM\ControlSet002\services\Flash Helper Service" /f</span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><ol><li>新建txt文件替换并禁用</li><li>更改访问权限和权限拥有者</li><li>再加上吾爱弹窗拦截</li></ol></blockquote></li></ol><h3 id="系统设置">系统设置</h3><p>如果有backup的话<span class="chineselangcomma">，</span>直接用就行<span class="chineselangstop">。</span></p><ol><li>关闭笔记本盖不进入睡眠模式（lid）</li><li>关闭蓝牙<span class="chineselangpause">、</span>调整缩放比例为100%</li><li>更改windows设置：夜间模式开启<span class="chineselangpause">、</span>连接鼠标时触摸板关闭<span class="chineselangpause">、</span>关闭存储我的历史记录（activity history）</li><li>更改隐私选项<span class="chineselangcomma">，</span>如关闭运行软件在后台运行<span class="chineselangpause">、</span>关闭voice等</li><li>更改notifications&amp;actions的quick actions排序及锁屏禁止notification</li><li>关闭Multitasking的timeline提示</li><li>关闭share across devices</li><li>打开clipboard history</li><li>把输入法option的candidate font size改为small<span class="chineselangcomma">，</span>关掉IME toolbar</li><li>个性化的colors改成灰色<span class="chineselangcomma">，</span>第二列最后一个</li><li>lock screen换成picture</li><li>到桌面-右键回收站<span class="chineselangcomma">，</span>更改回收站最大存储空间及非系统盘的文件直接永久删除</li><li>删除所有桌面图标（主题-更改桌面图标）</li><li>轮换屏保</li><li>adjust ClearType text</li><li>start界面的tiles设定</li><li>关闭taskbar的人脉</li><li>用<code>fiddler</code> to <a href="https://docs.microsoft.com/en-us/archive/blogs/fiddler/revisiting-fiddler-and-win8-immersive-applications" target="_blank" rel="noopener">permit AppContainers(Store<span class="chineselangpause">、</span>To-do list<span class="chineselangpause">、</span>OneNote<span class="chineselangpause">、</span>Cortana) to send traffic to the local computer.</a> 解决挂梯子时的同步问题和某些傻逼软件无法同步就疯狂读写硬盘占用CPU的傻逼行径<span class="chineselangstop">。</span></li><li>关闭sound control panel中的通信时降低其他应用声音（针对钉钉）<br><img src="//cdn.jsdelivr.net/gh/edfus/storage/images/.io/2019/12/deployment-win10/2020-05-21_183135.png.webp" alt="image"></li></ol><h3 id="软件设置">软件设置</h3><ol><li>设置honeyview外观及热键（极简+放大缩小快捷键）</li><li>Typora设置（通用/主题）（注意image的设置）</li><li>oneNote样式</li><li>安装HP软件<span class="chineselangcomma">，</span>连上打印机</li><li>Sublime Text直接原样替换appdata/roaming里面的文件就行</li><li>disable掉雷蛇</li><li>把chrome网站设置为默认静音</li><li>更改网易云音乐的音乐存储位置<span class="chineselangpause">、</span>缓存目录</li><li>更改AE缓存目录<span class="chineselangpause">、</span>数据库存储位置</li><li>把chrome的搜索引擎换成<code>https://www.google.com/search?q=%s&amp;pws=0&amp;gl=us&amp;gws_rd=cr</code> 不受地区限制</li><li>把sublime_text.exe.lnk放到..\Git\Git\cmd目录(%path%)<span class="chineselangcomma">，</span>并把core.editor全局设为&quot;start sublime_text.exe.lnk&quot;</li></ol><h3 id="美化">美化</h3><ol><li>rainmeter皮肤安装</li></ol><blockquote><p>注意：</p><p>中文乱码用unicode</p><p><a href="https://www.cnblogs.com/renyuan/p/4111695.html" target="_blank" rel="noopener">INI配置文件的格式</a></p><p>最后记得固定元素位置（禁止拖动）和保存主题/布局</p><p>layout(roaming里的Rainmeter.ini文件)是和文件路径有关的,若遇错可检查之<span class="chineselangstop">。</span></p></blockquote><ol start="2"><li><p>自定义鼠标样式安装</p></li><li><p>添加工作栏</p></li><li><p>更改文件夹显示方式,显示后缀</p></li><li><p>任务栏中置（取消锁定工具栏<span class="chineselangcomma">，</span>并创建多个空工具栏然后拖拖拖）</p></li><li><p>透明化（ TB transparent ） --MAXINISED WINDOW记得改</p></li><li><p>菜单栏管理</p></li></ol><blockquote><p>C:\Users\edfus\AppData\Roaming\Microsoft\Windows\Start Menu\Programs</p><p>C:\ProgramData\Microsoft\Windows\Start Menu\Programs</p></blockquote><ol start="9"><li>启动项管理</li></ol><blockquote><p>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp<br>C:\Users\edfus\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup (即shell:startup)</p></blockquote><ol start="10"><li>Dism++<ul><li>禁用启动项</li><li><kbd>shift</kbd>右键打开命令窗口选项</li><li>关闭<code>quick access</code>最近浏览\常用</li><li>隐藏七大家</li><li>关闭shortcut suffix</li><li>右键菜单禁用</li></ul></li><li>right menu mgr右键菜单管理</li><li>Download文件夹：group by: (none)</li></ol><h3 id="task-scheduler设定">task scheduler设定</h3><ol><li>定时关网易云音乐</li><li>定时提醒</li><li>定时断网</li><li>定时关机x2（后者记得随机时间</li><li>开机后定时开启typora</li><li>开机后定时百度贴吧签到</li><li>开机后禁止微软更新</li><li>月度备份提醒</li><li>在idle时杀掉trustedInstaller及其子进程</li></ol><h3 id="导入微软拼音词典和用户自设词典">导入微软拼音词典和用户自设词典</h3><h3 id="迁移hexo和git">迁移hexo和git</h3><h4 id="切换npm源">切换npm源</h4><blockquote><p>用<code>nrm</code>切换成淘宝的镜像源来使用(但还是会有部分依赖包必须从国外下载,所以还是推荐自己去学会科学上网),使用方法如下:</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm i nrm -g     <span class="comment">//全局安装 nrm 这个插件</span></span><br><span class="line">nrm test         <span class="comment">//测试哪个镜像源跟自己的延迟比较低,我的是 taobao</span></span><br><span class="line">nrm <span class="keyword">use</span> taobao   <span class="comment">//切换到taobao 这个镜像源上</span></span><br><span class="line">npm i ...        <span class="comment">//之后继续使用 npm 来安装相关依赖就行</span></span><br></pre></td></tr></table></figure><p><img src="//cdn.jsdelivr.net/gh/edfus/storage/images/.io/2019/12/deployment-win10/4024009-1b4094105736247f.webp" alt="image"></p></blockquote><h4 id="node-modules">node_modules</h4><blockquote><p>First, delete <code>node_modules</code> under your Hexo site directory. Then copy your Hexo site directory to your new device. Run <code>npm install hexo-cli -g &amp;&amp; npm install</code> in your site directory on your new device. Then you will be able to use Hexo on your new device.</p></blockquote><h4 id="gulp">gulp</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全局安装gulp模块</span></span><br><span class="line">npm install gulp -g</span><br><span class="line"><span class="comment"># 安装各种小功能模块  执行这步的时候&lt;span class='chineselangcomma'&gt;，&lt;/span&gt;可能会提示权限的问题&lt;span class='chineselangcomma'&gt;，&lt;/span&gt;最好以管理员模式执行</span></span><br><span class="line">npm install gulp gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-uglify gulp-imagemin --save</span><br><span class="line"><span class="comment"># 额外的功能模块</span></span><br><span class="line">npm install gulp-debug gulp-clean-css gulp-changed gulp-if gulp-plumber gulp-babel babel-preset-es2015 del @babel/core --save</span><br></pre></td></tr></table></figure><h4 id="git更新ssh">git更新ssh</h4><p>全局配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name edfus</span><br><span class="line">git config --global user.email edfus@gmail.com</span><br><span class="line"><span class="comment"># 注：edfus@gmail.com这个邮箱已弃用&lt;span class='chineselangstop'&gt;。&lt;/span&gt;</span></span><br><span class="line"><span class="comment"># 取消全局配置：</span></span><br><span class="line"><span class="comment"># git config --global --unset user.name</span></span><br><span class="line"><span class="comment"># git config --global --unset user.email</span></span><br></pre></td></tr></table></figure><p>为需要<strong>单独设置</strong>的仓库配置用户名和邮箱</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config user.name <span class="string">"edfus"</span> </span><br><span class="line">git config user.email <span class="string">"edfus@gmail.com"</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">"edfus@gmail.com"</span> <span class="comment">#生成</span></span><br></pre></td></tr></table></figure><p>之后有文件命名<span class="chineselangpause">、</span>设置密码等<span class="chineselangcomma">，</span>注意文件命名不要覆盖之前的<span class="chineselangcomma">，</span>以及新生成文件的保存路径<span class="chineselangstop">。</span><br>完成后把新的.pub公匙中的内容添加到github的ssh</p><p>.ssh目录下新建config文件（无后缀<span class="chineselangcomma">，</span>编码plain text)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Host edfus.github.com <span class="comment">#注意！Host是你在clone / push时应在@后面添加&lt;span class='chineselangpause'&gt;、&lt;/span&gt;重定向的“shortcut”</span></span><br><span class="line">HostName github.com</span><br><span class="line">IdentityFile C:\\Users\\edfus\\.ssh\\id_rsa_edfus </span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">User edfus@gmail.com</span><br></pre></td></tr></table></figure><p>测试是否生效：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@edfus.github.com <span class="comment">#edfus.github.com&lt;span class='chineselangcomma'&gt;，&lt;/span&gt;不是github.com</span></span><br></pre></td></tr></table></figure><h2 id="附：">附：</h2><h3 id="chrome的webRTC泄漏原IP-即使挂了VPN">chrome的webRTC泄漏原IP(即使挂了VPN)</h3><p><del>感谢恶俗wiki</del></p><blockquote><p>WebRTC (Web Real-Time Communications) 是一项实时通讯技术<span class="chineselangcomma">，</span>它允许网络应用或者站点<span class="chineselangcomma">，</span>在不借助中间媒介的情况下<span class="chineselangcomma">，</span>建立浏览器之间点对点（Peer-to-Peer）的连接<span class="chineselangcomma">，</span>实现视频流和（或）音频流或者其他任意数据的传输<span class="chineselangstop">。</span>WebRTC包含的这些标准使用户在无需安装任何插件或者第三方的软件的情况下<span class="chineselangcomma">，</span>创建点对点（Peer-to-Peer）的数据分享和电话会议成为可能<span class="chineselangstop">。</span></p></blockquote><p><a href="https://ip.voidsec.com/" target="_blank" rel="noopener">https://ip.voidsec.com/</a> &lt;-测试是否webRTC泄漏</p><p>谷歌商店有相关插件<span class="chineselangcomma">，</span>也可在GitHub搜索一下<span class="chineselangstop">。</span></p><h3 id="禁用win10更新（家庭版）（不推荐）">禁用win10更新（家庭版）（不推荐）</h3><ol><li><p>Windows更新失败怎么办 - robin的文章 - 知乎 <a href="https://zhuanlan.zhihu.com/p/30267264" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/30267264</a></p></li><li><p>删除其中所有内容并禁用C:\Windows\SoftwareDistribution\Download文件夹的所有权限（禁用继承+删除权限）（我把SoftwareDistribution文件夹也禁了）（注：我不认为这步有起到关键作用）</p></li><li><p>保存为bat格式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">:<span class="comment">#1</span></span><br><span class="line">sc config wuauserv start= disabled error= ignore</span><br><span class="line">sc config BITS start= disabled</span><br><span class="line">:<span class="comment">#2</span></span><br><span class="line">taskkill /f /t /im TiWorker.exe</span><br><span class="line">taskkill /f /t /im TrustedInstaller.exe</span><br><span class="line">sc config TrustedInstaller start= disabled</span><br></pre></td></tr></table></figure><p>添加进task scheduler<span class="chineselangcomma">，</span>勾选用最高权限执行<span class="chineselangcomma">，</span>每次开机运行第一段<span class="chineselangpause">、</span>电脑idle时运行第二段就好</p></li><li><p>设置按流量计费（metered connection)（注：我不认为这步有起到关键作用）</p></li><li><p>注册表更改相关内容 <code>.reg</code></p><p>我使用的版本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU]</span><br><span class="line">&quot;NoAutoUpdate&quot; &#x3D; dword:00000001</span><br><span class="line">&quot;AUOptions&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;ScheduledInstallDay&quot; &#x3D; dword : 00000000</span><br><span class="line">&quot;NoAutoRebootWithLoggedOnUsers&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;AutoInstallMinorUpdates&quot; &#x3D; dword : 00000000</span><br><span class="line">&quot;NoAUShutdownOption&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;UseWUServer&quot; &#x3D; dword : 00000001</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate]</span><br><span class="line">&quot;DisableOSUpgrade&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;DoNotConnectToWindowsUpdateInternetLocations&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;DisableWindowsUpdateAccess&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;WUServer&quot; &#x3D; &quot;127.0.0.1&quot;</span><br><span class="line">&quot;WUStatusServer&quot; &#x3D; &quot;127.0.0.1&quot;</span><br><span class="line">&quot;UpdateServiceUrlAlternate&quot; &#x3D; &quot;127.0.0.1&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate]</span><br><span class="line">&quot;SusClientId&quot; &#x3D; -</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update]</span><br><span class="line">&quot;AUOptions&quot; &#x3D; dword:00000001</span><br><span class="line">&quot;CachedAUOptions&quot; &#x3D; dword : 00000001</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wuauserv]</span><br><span class="line">&quot;Start&quot; &#x3D; dword : 00000004</span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU]</span><br><span class="line">&quot;NoAutoUpdate&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;AUOptions&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;ScheduledInstallDay&quot; &#x3D; dword : 00000000</span><br><span class="line">&quot;NoAutoRebootWithLoggedOnUsers&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;AutoInstallMinorUpdates&quot; &#x3D; dword : 00000000</span><br><span class="line">&quot;NoAUShutdownOption&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;UseWUServer&quot; &#x3D; dword : 00000001</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate]</span><br><span class="line">&quot;DisableOSUpgrade&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;DoNotConnectToWindowsUpdateInternetLocations&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;DisableWindowsUpdateAccess&quot; &#x3D; dword : 00000001</span><br><span class="line">&quot;WUServer&quot; &#x3D; &quot;127.0.0.1&quot;</span><br><span class="line">&quot;WUStatusServer&quot; &#x3D; &quot;127.0.0.1&quot;</span><br><span class="line">&quot;UpdateServiceUrlAlternate&quot; &#x3D; &quot;127.0.0.1&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate]</span><br><span class="line">&quot;SusClientId&quot; &#x3D; -</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update]</span><br><span class="line">&quot;AUOptions&quot; &#x3D; dword:00000001</span><br><span class="line">&quot;CachedAUOptions&quot; &#x3D; dword : 00000001</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wuauserv]</span><br><span class="line">&quot;Start&quot; &#x3D; dword : 00000004</span><br></pre></td></tr></table></figure><p>一些注释：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MRT]</span><br><span class="line">&quot;DontOfferThroughWUAU&quot;&#x3D;dword:00000001 ;Windows更新不包括恶意软件删除工具</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate]</span><br><span class="line">&quot;ExcludeWUDriversInQualityUpdate&quot;&#x3D;dword:00000001 ;Windows更新不包括驱动程序【0包括驱动&lt;span class&#x3D;&#39;chineselangcomma&#39;&gt;，&lt;&#x2F;span&gt;1不包括驱动】</span><br><span class="line">&quot;DisableOSUpgrade&quot;&#x3D;dword:00000001 ;屏蔽Windows 10升级提醒</span><br><span class="line">&quot;DoNotConnectToWindowsUpdateInternetLocations&quot;&#x3D;dword:00000001 ;微软网页介绍</span><br><span class="line">&quot;DisableWindowsUpdateAccess&quot;&#x3D;dword:00000001 ;微软网页介绍</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU]</span><br><span class="line">&quot;AUOptions&quot;&#x3D;dword:00000001 ;此项设置在组策略 &#x2F; 计算机配置 &#x2F; 管理模板 &#x2F; Windows组件 &#x2F;Windows更新 →【配置自动更新】已禁用</span><br><span class="line">; 数值名称：AUOptions</span><br><span class="line">; 数值数据：1 到 5</span><br><span class="line">; 1：自动更新中的“保持我的计算机最新”已被禁用&lt;span class&#x3D;&#39;chineselangstop&#39;&gt;。&lt;&#x2F;span&gt;</span><br><span class="line">; 2：提醒下载和安装&lt;span class&#x3D;&#39;chineselangstop&#39;&gt;。&lt;&#x2F;span&gt;</span><br><span class="line">; 3：自动下载并提醒安装&lt;span class&#x3D;&#39;chineselangstop&#39;&gt;。&lt;&#x2F;span&gt;</span><br><span class="line">; 4：自动下载并自动执行计划的安装&lt;span class&#x3D;&#39;chineselangstop&#39;&gt;。&lt;&#x2F;span&gt;</span><br><span class="line">; 5：允许本地管理员设置&lt;span class&#x3D;&#39;chineselangstop&#39;&gt;。&lt;&#x2F;span&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;NoAutoUpdate&quot;&#x3D;dword:00000001 ;【0：启用自动更新（默认）；1禁用自动更新&lt;span class&#x3D;&#39;chineselangstop&#39;&gt;。&lt;&#x2F;span&gt; 】</span><br><span class="line">&quot;NoAUShutdownOption&quot;&#x3D;dword:00000001 ;关闭Windows时对话框不显示&quot;安装更新并关机&quot;</span><br><span class="line">&quot;AutoInstallMinorUpdates&quot;&#x3D;dword:00000000 ;自动安装无需重启的更新【0不自动安装&lt;span class&#x3D;&#39;chineselangcomma&#39;&gt;，&lt;&#x2F;span&gt;1自动安装】</span><br><span class="line">&quot;NoAutoRebootWithLoggedOnUsers&quot;&#x3D;dword:00000001 ;更新挂起时如果有用户登录不自动重启计算机【0重启&lt;span class&#x3D;&#39;chineselangcomma&#39;&gt;，&lt;&#x2F;span&gt;1不重启】</span><br><span class="line">&quot;UseWUServer&quot;&#x3D;dword:00000001 ;微软网页介绍</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update]</span><br><span class="line">&quot;AUOptions&quot;&#x3D;dword:00000001 ;将Windows Update自动更新调整为【从不检查更新(不推荐)】</span><br><span class="line">&quot;CachedAUOptions&quot;&#x3D;dword:00000001 ;关闭自动更新</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\wuauserv]</span><br><span class="line">&quot;Start&quot;&#x3D;dword:00000004 ;服务&#x2F; Windows Update &#x2F; 禁用</span><br></pre></td></tr></table></figure></li></ol><h3 id="win10激活">win10激活</h3><p>姑且记录下以防万一<span class="chineselangstop">。</span></p><ul><li><p>密匙激活</p></li><li><p>KMS激活（在powershell中使用administration权限操作</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(Get-WmiObject -query <span class="string">'select * from SoftwareLicensingService'</span>).OA3xOriginalProductKey</span><br><span class="line"><span class="comment"># 查看本机密匙（powershell)</span></span><br><span class="line">slmgr.vbs /upk</span><br><span class="line"><span class="comment"># 卸载本机密匙（powershell)</span></span><br><span class="line">slmgr.vbs -xpr</span><br><span class="line"><span class="comment"># 查看本机激活状态(powershell)</span></span><br><span class="line">slmgr.vbs -skms zh.us.to</span><br><span class="line">slmgr /skms xxx.xxx.xxx </span><br><span class="line"><span class="comment"># zh.us.to&lt;span class='chineselangpause'&gt;、&lt;/span&gt;xxx.xxx.xxx为KMS服务器地址</span></span><br><span class="line">slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX</span><br><span class="line"><span class="comment"># Windows 10 Professional的GVLK密钥是W269N-WFGWX-YVC9B-4J6C9-T83GX</span></span><br><span class="line">slmgr /ato    </span><br><span class="line"><span class="comment"># 进行激活&lt;span class='chineselangcomma'&gt;，&lt;/span&gt;相当于刷新</span></span><br><span class="line">slmgr /dlv   </span><br><span class="line"><span class="comment"># 查看许可证详细信息</span></span><br></pre></td></tr></table></figure></blockquote></li><li><p>数字权利激活</p><blockquote><p>似乎一个数字权利只能对一台电脑起效<span class="chineselangstop">。</span>WIN7可同时作用于三台电脑<span class="chineselangcomma">，</span>但当时免费升级WIN10获得digital license后只能作用于一台电脑了</p></blockquote><blockquote><p><a href="https://support.microsoft.com/en-us/help/20530/windows-10-reactivating-after-hardware-change" target="_blank" rel="noopener">Reactivating Windows 10 after a hardware change</a></p></blockquote><blockquote><p><a href="https://zhidao.baidu.com/question/1308349909169305259.html" target="_blank" rel="noopener">如何使用 Win10 关联的数字权利激活新的电脑</a></p></blockquote></li></ul></div><footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/categories/tech/Win10/" rel="tag">Win10</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/categories/tech/优化/" rel="tag">优化</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/categories/tech/总结/" rel="tag">总结</a></li></ul><a data-clipboard-text="win10快速部署与优化
https://edfus.xyz/2019/12/deployment-win10/" class="article-share-link" href="javascript: void(0)" onclick="return window.copy2clipboard(this)">Share</a><aside class="article-share-success" aria-hidden="true">Share link copied</aside></footer></div><nav id="article-nav"><h3>相关文章：</h3><ul class="related-posts outer"><li><a href="/2019/12/why-Flash-dies-off/" class="article-more-link">Flash为何会被淘汰？</a><a href="/categories/tech/总结/" class="article-more-tag-link" rel="tag">总结</a><a href="/categories/tech/Flash/" class="article-more-tag-link" rel="tag">Flash</a></li><li><a href="/2020/01/v2ray-aws/" class="article-more-link">用aws来玩玩V2ray</a><a href="/categories/tech/总结/" class="article-more-tag-link" rel="tag">总结</a><a href="/categories/tech/aws/" class="article-more-tag-link" rel="tag">aws</a><a href="/categories/tech/VPN/" class="article-more-tag-link" rel="tag">VPN</a></li></ul></nav></article><section id="gitalk" itemprop="comment"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/edfus/storage/gitalk/gitalk.css"><script src="https://cdn.jsdelivr.net/gh/edfus/storage/gitalk/gitalk.min.js"></script><div id="gitalk-container"></div><script>var gitalk=new Gitalk({clientID:"e416342d498f5b12cc5c",clientSecret:"cc13255dddbbb4b3acaa93750e10d8e48d935b19",repo:"edfus.github.io",owner:"edfus",admin:["edfus"],id:"ID-ecd78a51f58f7a8bef8ad94aa7a62ebf",distractionFreeMode:!1,createIssueManually:!0,title:"win10快速部署与优化",body:"Category: tech<br>https://edfus.xyz/2019/12/deployment-win10/",pagerDirection:"first"});gitalk.render("gitalk-container")</script></section></section></div><footer id="footer"><div id="footer-info">&copy; 2020 edfus<br>Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a><br><span class="post-count">站点总字数：38万+</span><br>♪ <span id="footer-song-name"><span class="delay0" style="animation:none 3.6s linear infinite;animation-delay:0ms">最</span><span class="delay1" style="animation:none 3.6s linear infinite;animation-delay:.4s">も</span><span class="delay2" style="animation:none 3.6s linear infinite;animation-delay:.8s">澄</span><span class="delay3" style="animation:none 3.6s linear infinite;animation-delay:1.2s">み</span><span class="delay4" style="animation:none 3.6s linear infinite;animation-delay:1.6s">わ</span><span class="delay5" style="animation:none 3.6s linear infinite;animation-delay:2s">た</span><span class="delay6" style="animation:none 3.6s linear infinite;animation-delay:2.4s">る</span><span class="delay7" style="animation:none 3.6s linear infinite;animation-delay:2.8s">空</span><span class="delay8" style="animation:none 3.6s linear infinite;animation-delay:3.2s">と</span><span class="delay9" style="animation:none 3.6s linear infinite;animation-delay:3.6s">海</span></span></div></footer><style>#footer a{color:#2ab8ff;background-color:rgba(0,0,0,.05);text-decoration:none;outline:0;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;transition:all .2s ease-in-out}#footer a:focus,#footer a:hover{color:#00ffce}#footer{background:linear-gradient(black,transparent),url(//cdn.jsdelivr.net/gh/edfus/storage/images/root/footer-reimu.png.webp),#121621;border-top:1px solid #fff;color:#fff;margin:20px auto 0;overflow:hidden;width:100%;background-repeat:no-repeat,no-repeat,no-repeat;background-position:0 0,calc(60% + 40px) 40%,0 0;background-size:contain}#footer-info{line-height:1.6em;font-size:.85em;padding:50px 20px;margin:0 auto;width:854px}@media screen and (max-width:479px){#footer{margin:0}#footer-info{padding:20px 0 20px 20px;width:calc(97.5% - 20px)}}</style></div><nav id="mobile-nav"><a href="/" class="mobile-nav-link" title="Home">Lifelog.</a> <a href="/categories/tech/" class="mobile-nav-link" title="Tech">[Geeky]</a> <a href="/about" class="mobile-nav-link" title="About">U.N. Owen!</a> <a href="/more/" class="mobile-nav-link" title="More">Novella & Skit</a></nav><a href="#" class="gotop" tabindex="-1"><img src="//cdn.jsdelivr.net/gh/edfus/storage/up.png.webp" alt="go to top"></a><script src="https://cdn.jsdelivr.net/gh/edfus/storage/js/script.js" async></script><script src="https://cdn.jsdelivr.net/gh/edfus/storage/glightbox/glightbox_modified.min.js" async></script></div></body></html>