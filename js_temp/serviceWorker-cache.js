{const e="cache-"+"3.2.3--beta",t="@1.1",n="https://cdn.jsdelivr.net/gh/edfus/storage",s=["/css/style.css","/css/style-more.css",n+"/js/script@1.2.js",`${n}/js/script-category${t}.js`,`${n}/js/script-more${t}.js`,`${n}/glightbox/glightbox${t}.min.js`],c=["https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js",n+"/gitalk/gitalk.css"],a="fontsCache-1.0",i=[{name:"筑紫A丸ゴシック",url:n+"/fonts/筑紫A丸ゴシック.woff2",unicodeRange:"U+4E00-9FCB"},{name:"Consolas",url:n+"/fonts/Consolas.woff2",unicodeRange:"U+0000-007F"}],o=e=>{caches.open(a).then(t=>{"connection"in navigator&&!navigator.connection.saveData?t.add(e.url).then(()=>{self.clients.matchAll().then(t=>t.forEach(t=>{t.postMessage(e)}))}):console.info("metered network?")})};self.addEventListener("install",t=>{self.skipWaiting(),t.waitUntil(caches.open(e).then(e=>e.addAll(s).then(()=>{"connection"in navigator&&!navigator.connection.saveData&&e.addAll(c).catch(e=>console.log(e))})).then(()=>{i.forEach(e=>{o(e)})}))}),self.addEventListener("message",(function(e){o(e.data)})),self.addEventListener("activate",(function(t){return console.log("[ServiceWorker] Activate."),t.waitUntil(caches.keys().then((function(t){return Promise.all(t.map((function(t){if(t!==e&&t!==a)return console.log("[ServiceWorker] Removing old cache:",t),caches.delete(t)})))}))),self.clients.claim()})),self.addEventListener("fetch",(function(t){let n=t.request.url.split("//")[1].split("/")[0];t.respondWith(caches.match(t.request).then((async function(s){if(null!=s)return s;{if("only-if-cached"===t.request.cache&&"same-origin"!==t.request.mode)return void console.dir(t.request);let s=t.request.clone();return await fetch(s).then(async t=>{if((!t||200!==t.status||"basic"!==t.type)&&("cors"!==t.type||"cdn.jsdelivr.net"!==n))return t;if("GET"===s.method){const n=await caches.open(e);await n.put(s.url,t.clone())}return t})}})))}))}